WITH daily_sales AS (SELECT  DATE(order_created_at)     AS day,
                             order_id                   AS order,
                             MAX(Final Bill)            AS order_value,
                       FROM  Table
                      GROUP  BY 1,2
)

SELECT  day,
        SUM(order_vale) AS daily_sales
  FROM  daily_sales
 GROUP  BY 1
  ;



  WITH daily_sales AS (SELECT  DATE(order_created_at)     AS day,
                               order_id                   AS order,
                               MAX(Final Bill)            AS order_value,
                         FROM  Table
                        GROUP  BY 1,2
  )

  SELECT  day,
          AVG(DATEDIFF ( MINUTE, ORDER_CREATED_AT, PREPARED_DATE_TIME)) AS prep_time
    FROM  daily_sales
   GROUP  BY 1
    ;


brand 1, *
brand 2, lower limit,<= 18th
rest 3,  lower>= 19th;


mapping Table

brand_nk, criteria


WHERE (brand ='brand1') OR (brand='brand2' AND date>=19th) OR ()

import pandas
